{{- define "eric-data-object-storage-mn.command" -}}
{{- $global := fromJson (include "eric-data-object-storage-mn.global" .) -}}
{{- $nodeCount := .Values.replicas | int -}}
# CMD for standalone mode
{{- if eq .Values.mode "standalone" }}
{{- if $global.security.tls.enabled }}
command: [ "minio", "--config-dir", "/minio", "--certs-dir", "/minio/certs", "server", "--json", "--quiet", "{{ .Values.mountPath }}" ]
{{- else }}
command: [ "minio", "server", "--config-dir", "/minio", "--json", "--quiet", "{{ .Values.mountPath }}" ]
{{- end -}}
# CMD for distributed mode
{{- else }}
{{- if $global.security.tls.enabled }}
command: [ "minio", "--config-dir", "/minio", "--certs-dir", "/minio/certs", "server", "--json", "--quiet",
{{- range $i := until $nodeCount -}}
"https://{{ template `eric-data-object-storage-mn.fullname` $ }}-{{ $i }}.{{ template `eric-data-object-storage-mn.fullname` $ }}-svc.{{ $.Release.Namespace }}.svc.{{ $.Values.clusterDomain }}{{ $.Values.mountPath }}",
{{- end }} ]
{{- else }}
command: [ "minio", "server", "--config-dir", "/minio", "--json", "--quiet",
{{- range $i := until $nodeCount -}}
"http://{{ template `eric-data-object-storage-mn.fullname` $ }}-{{ $i }}.{{ template `eric-data-object-storage-mn.fullname` $ }}-svc.{{ $.Release.Namespace }}.svc.{{ $.Values.clusterDomain }}{{ $.Values.mountPath }}",
{{- end }} ]
{{- end -}}
{{- end -}}
# CMD end
{{- end -}}


